<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Node Flow Editor</title>
    <link rel="stylesheet" href="bulma.min.css">
    <link rel="stylesheet" href="node_editor_base.css">
    <link rel="stylesheet" href="contextmenu.css">
    <script src="node_editor_base.js"></script>
    <script src="contextmenu.js"></script>
</head>
<body>
    <!--
        based on:
        https://www.youtube.com/watch?v=1JNbGf8dhAQ
    -->


    <div id="boardWrapper" class="boardWrapper">
        <div id="board" class="board">
            <div class="dropdown is-active" id="dropdown-menu-node-wrapper">
                <div>
                <article class="message is-info dropdown-menu">
                    <div class="message-header has-text-info-light">
                      Add node
                    </div>
                <div class="dropdown-menu" id="dropdown-menu-node" role="menu">
                  <div class="dropdown-content">
                    <template class="dropdown-item-template">
                        <a href="#" class="dropdown-item">
                        </a>
                    </template>
                    <template class="dropdown-item-template-divider">
                        <hr class="dropdown-divider">
                    </template>
                  </div>
                </div>
                </article>
                </div>
            </div>
        </div>

        <template class="nodeTemplateAdd">
            <article class="node message is-info is-small">
                <div class="message-header is-small">
                  Add
                  <button class="delete is-small"></button>
                </div>
                <div class="message-body">
                  
                </div>
                <div class="inputsWrapper">
                    <div class="inputNode"></div>
                    <div class="inputNode"></div>
                </div>
                <div class="outputsWrapper">
                    <div class="outputNode"></div>
                </div>
            </article>
        </template>

        <template class="nodeTemplateAverage">
            <article class="node message is-info is-small">
                <div class="message-header is-small">
                  Average
                  <button class="delete is-small"></button>
                </div>
                <div class="message-body">
                  
                </div>
                <div class="inputsWrapper">
                    <div class="inputNode"></div>
                </div>
                <div class="outputsWrapper">
                    <div class="outputNode"></div>
                </div>
            </article>
        </template>

        <template class="nodeTemplateMath">
            <article class="node message is-info is-small">
                <div class="message-header is-small">
                  Math
                  <button class="delete is-small"></button>
                </div>
                <div class="message-body">
                    <select class="input node-math-type">
                        <option value="add">Add</option>
                        <option value="subtract">Subtract</option>
                        <option value="multiply">Multiply</option>
                        <option value="divide">Divide</option>
                    </select>
                </div>
                <div class="inputsWrapper">
                    <div class="inputNode"></div>
                    <div class="inputNode"></div>
                </div>
                <div class="outputsWrapper">
                    <div class="outputNode"></div>
                </div>
            </article>
        </template>

        <template class="nodeTemplateNumber">
            <article class="node message is-info is-small">
                <div class="message-header is-small">
                  Number
                  <button class="delete is-small"></button>
                </div>
                <div class="message-body">
                    <input class="input node-math-value" type="number" step="0.1" value="0">
                </div>
                <div class="inputsWrapper">
                    <div class="inputNode"></div>
                    <div class="inputNode"></div>
                </div>
                <div class="outputsWrapper">
                    <div class="outputNode"></div>
                </div>
            </article>
        </template>

        <template class="nodeTemplateOutput">
            <article class="node message is-primary is-small  has-background-success-light">
                <div class="message-header is-small">
                  Output
                  <button class="delete is-small"></button>
                </div>
                <div class="message-body">
                    
                </div>
                <div class="inputsWrapper">
                    <div class="inputNode"></div>
                </div>
            </article>
        </template>

        <template class="edgeTemplate">
            <svg class="edgeWrapper">
                <path class="edgeNew"/>
                <g class="deleteButton deleteHidden" transform="translate(0,0)">
                    <circle class="circle" />
                    <svg
                        fill="currentColor"
                        stroke-width="0"
                        width="30"
                        height="30"
                        viewBox="150 150 1000 1000"
                        style="overflow: visible;"
                        class="icon"
                    >
                    <g>
                        <line fill="#FFFFFF" stroke="#FFFFFF" stroke-width="100" x1="0" y1="0" x2="300" y2="300"/>
                        <line fill="#FFFFFF" stroke="#FFFFFF" stroke-width="100" x1="0" y1="300" x2="300" y2="0"/>
                    </g>
                </g>
            </svg>
        </template>
    </div>

    <script type="text/javascript">
        let n = new NodeFlowEditor(document.getElementById("board"), document.getElementById("boardWrapper"));
        n.addNode({type: "Math"}, 100,200);
        n.addNode({type: "Add"}, 350,100);
        n.addNode({type: "Number"}, 600,100);
        n.addNode({type: "Average"}, 350,400);

        document.addEventListener('keydown', function(event) {
            console.log(0);
            if(event.shiftKey && event.key == 'E') {
                window.nodeData = n.exportData();
            }
            if(event.shiftKey && event.key == 'I') {
                n.loadData(window.nodeData);
            }
        });
    </script>

</body>
